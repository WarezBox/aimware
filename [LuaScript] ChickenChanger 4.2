local msc_ref = gui.Reference( "VISUALS", "OTHER","Filter" );
--local lua_groupbox = gui.Groupbox( msc_ref, "ChickenShit", 0, 5 );
local lua_EnableChicken = gui.Checkbox( msc_ref, "lua_EnableChicken", "Chicken Changer", 1 );
local lua_ChickenScale = gui.Slider( msc_ref, "lua_ChickenScale", "Chicken Scale", 1.0, 0.25, 4.0 );
local lua_ChickenColor = gui.Combobox( msc_ref, "lua_ChickenColor", "Chicken Color","Off","Solid", "Rainbow");
local lua_ChickenRainbowSpeed = gui.Slider( msc_ref, "lua_ChickenRainbowSpeed", "Chicken Color Speed", 1.0, 0.25, 4.0 );
local lua_ChickenModel = gui.Combobox( msc_ref, "lua_ChickenModel", "Holiday Theme","Default Chicken", "Party Chicken","Ghost Chicken","Festive Chicken","Easter Chicken","Jack-o-Chicken");
local lua_ChickenSkin = gui.Combobox( msc_ref, "lua_ChickenSkin", "Chicken Skin","Default", "Other");
local lua_EnableParty = gui.Checkbox( msc_ref, "lua_EnableParty", "sv_partymode 1", 0 );
local lua_ChickenAA = gui.Checkbox( msc_ref, "lua_ChickenAA", "ChickenAA", 0 );
local Chicken_Color = gui.ColorEntry( "Chicken_Color", "Chicken Color", 0, 0, 0,255)

local function RGB2clr(R, G, B)
return 0xFFFFFF & ((R&0xFF)|((G&0xFF)<<8)|((B&0xFF)<<16))
end

local function ChickenShit()
    local speed =  lua_ChickenRainbowSpeed:GetValue()
  local r = math.floor(math.sin(globals.RealTime() * speed) * 127 + 128)
  local g = math.floor(math.sin(globals.RealTime() * speed + 2) * 127 + 128)
  local b = math.floor(math.sin(globals.RealTime() * speed + 4) * 127 + 128)
chickens = entities.FindByClass("CChicken") 

if lua_EnableChicken:GetValue() then


  if lua_ChickenColor:GetValue() == 0 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_clrRender") ~= RGB2clr(255,255,255) then
                  chicken:SetProp("m_clrRender", RGB2clr(255,255,255));   
              else
          end
      end
  elseif lua_ChickenColor:GetValue() == 1 then
      for i=1, #chickens do
          local chicken = chickens[i] 
if chicken:GetProp("m_clrRender") ~= RGB2clr(Chicken_Color:GetValue()) then
  chicken:SetProp("m_clrRender", RGB2clr(Chicken_Color:GetValue()));   
else
end
      end       
  elseif lua_ChickenColor:GetValue() == 2 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_clrRender") ~= RGB2clr(r,g,b) then
                  chicken:SetProp("m_clrRender", RGB2clr(r,g,b));   
              else
          end
      end       
  else
  end


  if lua_ChickenModel:GetValue() == 0 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_nBody") ~= 0 then
                  chicken:SetProp("m_nBody", 0);   
              else
          end
      end
  elseif lua_ChickenModel:GetValue() == 1 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_nBody") ~= 1 then
                  chicken:SetProp("m_nBody", 1);   
              else
          end
      end
  elseif lua_ChickenModel:GetValue() == 2 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_nBody") ~= 2 then
                  chicken:SetProp("m_nBody", 2);   
              else
          end
      end
  elseif lua_ChickenModel:GetValue() == 3 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_nBody") ~= 3 then
                  chicken:SetProp("m_nBody", 3);   
              else
          end
      end
  elseif lua_ChickenModel:GetValue() == 4 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_nBody") ~= 4 then
                  chicken:SetProp("m_nBody", 4);   
              else
          end
      end
  elseif lua_ChickenModel:GetValue() == 5 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_nBody") ~= 5 then
                  chicken:SetProp("m_nBody", 5);   
--chicken:SetProp("m_flPlaybackRate", 30.0);    --EDIT ME TARD
              else
          end
      end
  else
  end
 
  if lua_ChickenSkin:GetValue() == 0 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_nSkin") ~= 0 then
                  chicken:SetProp("m_nSkin", 0);   
              else
          end
      end
  elseif lua_ChickenSkin:GetValue() == 1 then
      for i=1, #chickens do
          local chicken = chickens[i] 
              if chicken:GetProp("m_nSkin") ~= 1 then
                  chicken:SetProp("m_nSkin", 1);   
              else
          end
      end       
  else
  end
 

  for i=1, #chickens do
      local chicken = chickens[i] 
          if chicken:GetProp("m_flModelScale") ~= lua_ChickenScale:GetValue() then
                  chicken:SetProp("m_flModelScale", lua_ChickenScale:GetValue());   
              else
          end
  end

else
 
  for i=1, #chickens do
      local chicken = chickens[i]     
          if chicken:GetProp("m_nBody") ~= 0 then
                  chicken:SetProp("m_nBody", 0);   
              else
          end       
          if chicken:GetProp("m_flModelScale") ~= 1.0 then
                  chicken:SetProp("m_flModelScale", 1.0);   
              else
          end
          if chicken:GetProp("m_nSkin") ~= 0 then
                  chicken:SetProp("m_nSkin", 0);   
              else
          end
  end
end

  if lua_EnableParty:GetValue() then
          if client.GetConVar("sv_party_mode") ~= 1 then
              client.SetConVar("sv_party_mode", 1, true)
              else
          end
      else
          if client.GetConVar("sv_party_mode") ~= 0 then
              client.SetConVar("sv_party_mode", 0, true)
              else
          end
  end

if lua_ChickenAA:GetValue() then
for i=1, #chickens do
          local chicken = chickens[i] 
          chicken:SetProp("m_nSequence", -509);   
      end
else
end
end
callbacks.Register( "Draw", "ChickenShit", ChickenShit );
